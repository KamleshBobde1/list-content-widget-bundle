(this["webpackJsonpentando-mf-template"]=this["webpackJsonpentando-mf-template"]||[]).push([[0],{55:function(t,e,n){},78:function(t,e){},79:function(t,e){},80:function(t,e,n){"use strict";n.r(e);var a=n(0),r=n.n(a),c=n(2),i=n(26),o=n(27),u=n(28),s=n(30),l=n(31),d=n(29),p=n.n(d),m=n(5),f=n(13),b=n(14),h=n(4),I=n.n(h),j="STRAPI_CONFIG",x=("".concat("/entando-template-api/api","/template/searchby/"),"EntKcToken"),v={Authorization:"".concat(x," ").concat("eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI5NWNKaVRjejRGTU00RFU5YWhaa0lVS3ZiZ0xEUEhsRDM5N190UG9YSDV3In0.eyJleHAiOjE2NTgyNTA5NTAsImlhdCI6MTY1ODI1MDY1MCwiYXV0aF90aW1lIjoxNjU4MjUwNjM5LCJqdGkiOiIxMTNlNDQ3My1hOThjLTRjMzItOGZhZC1hYWNkZTk2OTgxOTEiLCJpc3MiOiJodHRwOi8vcXVpY2tzdGFydC4xNzIuNDAuMC4xNDIubmlwLmlvL2F1dGgvcmVhbG1zL2VudGFuZG8iLCJhdWQiOlsicG4tZDdhZTc4YjItMWYzMWNiZDktYWtoaWxlc2hwcmFqYXBhdGludi1lbnQtcHJvamVjdC10ZW1wbGF0ZS1zZXJ2ZXIiLCJhY2NvdW50Il0sInN1YiI6ImM3NjgyODFmLTIxYTMtNDQyZC04OWMwLTY1OWVkMGE0ODA3YiIsInR5cCI6IkJlYXJlciIsImF6cCI6ImVudGFuZG8td2ViIiwibm9uY2UiOiI3NzQyNDM2Zi1mMjMxLTQ2MzctOTk5OC1jNzdjMDVjYmFhODMiLCJzZXNzaW9uX3N0YXRlIjoiOTViODFlZWMtNjU1ZS00N2RlLWIyYzQtZDYxMjFhMzRiM2FjIiwiYWNyIjoiMCIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vcXVpY2tzdGFydC4xNzIuNDAuMC4xNDIubmlwLmlvIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsInVtYV9hdXRob3JpemF0aW9uIiwiZGVmYXVsdC1yb2xlcy1lbnRhbmRvIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsicG4tZDdhZTc4YjItMWYzMWNiZDktYWtoaWxlc2hwcmFqYXBhdGludi1lbnQtcHJvamVjdC10ZW1wbGF0ZS1zZXJ2ZXIiOnsicm9sZXMiOlsiZW50YW5kb0FwcCIsImV0LXNlY29uZC1yb2xlIiwiZXQtZmlyc3Qtcm9sZSJdfSwiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJvcGVuaWQgZW1haWwgcHJvZmlsZSIsInNpZCI6Ijk1YjgxZWVjLTY1NWUtNDdkZS1iMmM0LWQ2MTIxYTM0YjNhYyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwicHJlZmVycmVkX3VzZXJuYW1lIjoiYWRtaW4ifQ.KAKuC1x19I6xp4nbNvRmTPNvYVrdGNh2Gz3FdGZyd6AJqaMpqE_dgh5dIL85nHpmxdAID8PYAZ-FAGvVkYyUDnhm63sbLcoa3gWE5RyaKKZgWX_l8iEKoA0eubc78TBBIVM1crwLIOD_kbMjfd8qdfa5CzsyYgTiGSOWRt9cmIIlABGV54XMDjRzMDIezd74bNF8caJWZcvaH-Rwmp33HBCnb0wmDx8--pdhGZ36z0-j4fSNDDfAE4bXn5OL-93uKoCDMGXuiMeWgsh7LypyFvid1v5epEu3OzX5SPQpTFQ-6xVyqDDAKMqiqupa3fMI7Kx5SrCEPbbE6uJlKl1bww")},y=function(){var t=Object(c.a)(r.a.mark((function t(e){var n,a;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,I.a.get("".concat("/entando-template-api/api","/template/").concat(e),k({}));case 2:return n=t.sent,a=n.data,t.abrupt("return",a);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),O=function(){var t=Object(c.a)(r.a.mark((function t(e){var n,a,c;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,I.a.get("".concat("/entando-template-api/api","/template/"),k({}));case 2:return n=t.sent,a=n.data,c=a.filter((function(t){return e.indexOf(t.id+"")>-1})),t.abrupt("return",c);case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),w=function(){var t=Object(c.a)(r.a.mark((function t(e,n){var a,c,i;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e||n.length||console.error(e),t.next=3,Y();case 3:return a=t.sent,c=n.map((function(t){return"".concat(a,"/content-manager/collection-types/api::").concat(e,".").concat(e,"/").concat(t)})),t.next=7,I.a.all(c.map((function(t){return I.a.get(t,k({},x))})));case 7:return i=t.sent,t.abrupt("return",i.map((function(t){return t.data})));case 9:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),g=function(){var t=Object(c.a)(r.a.mark((function t(e,n,a){var c,i,o,u;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c=null,t.t0=I.a,t.t1="",t.next=5,Y();case 5:return t.t2=t.sent,t.t3=t.t1.concat.call(t.t1,t.t2,"/content-manager/collection-types/api::").concat(e,".").concat(e,"?page=1&pageSize=100&sort=createdAt:DESC&filters[").concat(n,"][$containsi]=").concat(a),t.t4=k({},x),t.next=10,t.t0.get.call(t.t0,t.t3,t.t4);case 10:if(i=t.sent,!(o=i.data.results)){t.next=19;break}return t.next=15,Y();case 15:return u=t.sent,t.next=18,I.a.all(o.map((function(t){return t.id})).map((function(t){return I.a.get("".concat(u,"/content-manager/collection-types/api::").concat(e,".").concat(e,"/").concat(t),k({},x))})));case 18:c=t.sent;case 19:return t.abrupt("return",c.length?c.map((function(t){return t.data})):[]);case 20:case"end":return t.stop()}}),t)})));return function(e,n,a){return t.apply(this,arguments)}}(),N=function(t){var e=window&&window.entando&&window.entando.keycloak&&window.entando.keycloak.authenticated?window.entando.keycloak.token:localStorage.getItem("token");return e?{headers:{Authorization:"".concat(t," ").concat(e)}}:t===x?{headers:v}:{}},k=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Bearer",n=N(e);return Object(b.a)(Object(b.a)({},t),n)},Z=function(){var t=Object(c.a)(r.a.mark((function t(){var e;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,I.a.get("http://172.40.0.142:8082/api/config/").then((function(t){return t})).catch((function(t){return t}));case 2:return e=t.sent,t.abrupt("return",M(e));case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),W=function(){var t=Object(c.a)(r.a.mark((function t(e){var n;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,I.a.head(e).then((function(t){return t})).catch((function(t){return t}));case 2:return n=t.sent,t.abrupt("return",M(n));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Y=function(){var t=Object(c.a)(r.a.mark((function t(){var e,n,a,c;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=localStorage.getItem(j)){t.next=14;break}return t.next=4,Z();case 4:if(n=t.sent,a=n.data,n.isError||!a||!a.data||!a.data.baseUrl){t.next=14;break}return t.next=10,W(a.data.baseUrl);case 10:if(!(c=t.sent)||!c.data||200!==c.data.status||c.isError){t.next=14;break}return localStorage.setItem(j,a.data.baseUrl),t.abrupt("return",a.data.baseUrl);case 14:return t.abrupt("return",e);case 15:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),M=function(t){var e=!1;return t.hasOwnProperty("toJSON")&&"Error"===t.toJSON().name&&(e=!0),{data:t,isError:e}},C=(n(55),n(1));function S(){return Object(C.jsxs)("div",{className:"msg-top well",children:[Object(C.jsx)("div",{children:Object(C.jsx)("div",{children:Object(C.jsxs)("strong",{children:[Object(C.jsx)("span",{className:"pficon pficon-warning-triangle-o"})," ","http://172.40.0.142:1337"," can't be reached. Please click ",Object(C.jsx)("a",{href:"http://172.40.0.142:3001",target:"_blank",children:"here"})," to configure it."]})})}),Object(C.jsx)("div",{className:"mt-2",children:Object(C.jsx)("button",{bsStyle:"primary",onClick:function(){return window.location.reload()},children:"Reload Page"})})]})}var D=n(57);var J=function(t){var e=t.contentName,n=t.contentIdsAndTemplateIds,a=t.saveQueryDetails,i=t.colLabelName,o=Object(m.useState)(null),u=Object(f.a)(o,2),s=u[0],l=u[1],d=Object(m.useState)(decodeURI(n)),p=Object(f.a)(d,2),b=p[0];function h(t){return I.apply(this,arguments)}function I(){return(I=Object(c.a)(r.a.mark((function t(n){var a,c,i;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Y();case 2:return a=t.sent,t.next=5,O(n.map((function(t){return t.templateId})));case 5:return c=t.sent,t.next=8,w(e,n.map((function(t){return t.contentId})));case 8:i=t.sent,N(c,i,n,a);case 10:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function x(){return v.apply(this,arguments)}function v(){return(v=Object(c.a)(r.a.mark((function t(){var n,c,o,u,s;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Y();case 2:return n=t.sent,c=JSON.parse(decodeURI(a)),t.next=6,g(e,i,c.searchTerm);case 6:return o=t.sent,t.next=9,y(c.templateId);case 9:u=t.sent,(s=o.map((function(t){return k(t,n),D.render(u.contentShape,{content:t})}))).length?l(s):console.error("App.js: No Content Found");case 12:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function N(t,e,n,a){if(t&&e&&Object.keys(n).length){var r=n.map((function(n){var r=e.filter((function(t){return t.id===n.contentId})),c=t.filter((function(t){return+t.id===+n.templateId}));return c.length&&r[0]&&Object.keys(r[0]).length?(k(r[0],a),D.render(c[0].contentShape,{content:r[0]})):""}));l(r)}}function k(t,e){Object.keys(t).map((function(n,a){t[n]&&Array.isArray(t[n])?t[n]&&t[n][0]&&t[n][0].ext&&t[n].map((function(t){return t.url=e+t.url})):t[n]&&"object"===typeof t[n]&&t[n]&&t[n].ext&&"object"===typeof t[n]&&(t[n].url=e+t[n].url)}))}return p[1],Object(m.useEffect)(Object(c.a)(r.a.mark((function t(){var n;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=b.length&&JSON.parse(b),!e){t.next=8;break}if(!a){t.next=5;break}return t.next=5,x();case 5:if(!n){t.next=8;break}return t.next=8,h(n);case 8:case"end":return t.stop()}}),t)}))),[]),localStorage.getItem(j)?Object(C.jsx)(C.Fragment,{children:s&&s.length?s.map((function(t,e){return Object(C.jsx)("div",{dangerouslySetInnerHTML:{__html:t}},e)})):Object(C.jsx)("h1",{children:"Loading..."})}):Object(C.jsx)(S,{})},V={contentName:"contentName",contentIdsAndTemplateIds:"contentIdsAndTemplateIds",saveQueryDetails:"saveQueryDetails",colLabelName:"colLabelName"},T=function(t){Object(u.a)(n,t);var e=Object(s.a)(n);function n(){var t;Object(i.a)(this,n);for(var a=arguments.length,o=new Array(a),u=0;u<a;u++)o[u]=arguments[u];return(t=e.call.apply(e,[this].concat(o))).getStrapiConfiguration=Object(c.a)(r.a.mark((function e(){var n,a,c;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return localStorage.removeItem(j),e.next=3,Z();case 3:if(n=e.sent,a=n.data,n.isError||!a||!a.data||!a.data.baseUrl){e.next=11;break}return e.next=9,W(a.data.baseUrl);case 9:(c=e.sent)&&c.data&&200===c.data.status&&!c.isError&&localStorage.setItem(j,a.data.baseUrl);case 11:t.render();case 12:case"end":return e.stop()}}),e)}))),t}return Object(o.a)(n,[{key:"attributeChangedCallback",value:function(t,e,n){if(!Object.values(V).includes(t))throw new Error("Untracked changed attribute: ".concat(t));this.mountPoint&&n!==e&&this.getStrapiConfiguration()}},{key:"connectedCallback",value:function(){this.mountPoint=document.createElement("div"),this.appendChild(this.mountPoint),this.getStrapiConfiguration()}},{key:"render",value:function(){var t=this.getAttribute(V.contentName),e=this.getAttribute(V.contentIdsAndTemplateIds),n=this.getAttribute(V.saveQueryDetails),a=this.getAttribute(V.colLabelName);p.a.render(Object(C.jsx)(J,{contentName:t,contentIdsAndTemplateIds:e,saveQueryDetails:n,colLabelName:a}),this.mountPoint)}}],[{key:"observedAttributes",get:function(){return Object.values(V)}}]),n}(Object(l.a)(HTMLElement));customElements.get("my-list-widget")||customElements.define("my-list-widget",T)}},[[80,1,2]]]);
//# sourceMappingURL=main.204c6325.chunk.js.map